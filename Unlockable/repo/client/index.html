<!DOCTYPE html>
<html lang="en-US" class="no-js">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Unlockable :: Modal Framework</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
    <!-- <link type="text/css" rel="stylesheet" href="css/screen.css"> -->
	<!-- <script src="/webapp-build/unlockable-min.js"></script> -->
    <script data-main="scripts/main" src="scripts/require/require.js"></script>
	<script src="scripts/lib/jquery-1.7.2.min.js"></script>
    <script type="text/javascript">

        var prmstr = window.location.search.substr(1);
        var prmarr = prmstr.split ("&");
        var params = {};
        var company;
        var touchObj;

        for ( var i = 0; i < prmarr.length; i++) {
            var tmparr = prmarr[i].split("=");
            params[tmparr[0]] = tmparr[1];
        }
        if (! ('name' in params)){
            params['name'] = "Amazon1024"
        }

        company = params['name']
       var randomnumber=Math.floor(Math.random()*1100)

        UnlockableData = {foreignId:randomnumber}

        //pull company from url, button top, button left
        //unlockable.com/? name=Pandora &top=697 &left=530
        //magic here, company, button_top, button_left have values

        window.unlockableInventory = function(hasInventory){

        }
        window.finishedUnlockable = function(hasInventory){
            $('.publisher-site').css("background-image", "url(media/img/fixtures/backgrounds/"+ company + "_Screen_Congrats.jpg)");
        }
        window.setupUnlockable = function(){

            $('#unlockable-btn').bind('touchend click', function(e){
                $('#unlockable-main').show()
                $('#unlockable-btn').hide()

                games = ['puzzle', 'trivia', 'frames', 'dropblocks']
                if ('games' in params){
                    games = params['games'].split(',')
                }
                data = {frames:'verizonShareFrames', trivia:'mcdsFishTrivia', puzzle: 'angelsoftPuzzle', dropblocks: 'angelsoftDropblocks'}
                if ('frames' in params){
                    data['frames'] = params['frames']
                }
                if ('trivia' in params){
                    data['trivia'] = params['trivia']
                }
                if ('puzzle' in params){
                    data['puzzle'] = params['puzzle']
                }
               if ('dropblocks' in params){
                    data['dropblocks'] = params['dropblocks']
                }

                Unlockable.setupFixtures(games, data)
                Unlockable.startUnlockable(UnlockableData)

            });
        }

        $(document).ready(function(){
            var publisherSite = $('.publisher-site');

            $('#unlockable-main').hide();

            publisherSite.css("background-image", "url(media/img/fixtures/backgrounds/" + company + "_Screen_Landing.jpg)");
            publisherSite.css("background-repeat", "no-repeat");

            switch(company){
                case "NYT":
                    publisherSite.addClass('NYT');
                break;
                case "Pandora":
                    publisherSite.addClass('Pandora');
                break;
                case "CondeNast":
                    publisherSite.addClass('CondeNast');
                break;
                case "Amazon1024":
                    publisherSite.addClass('Amazon1024');
                break;
                case "Moxie":
                    publisherSite.addClass('Moxie');
                break;
            }

        });

    </script>

  </head>

  <body>
    <style>
        body{
            margin: 0;
        }
        html, body, .publisher-site{
            width: 100%;
            height: 100%;
        }
        .publisher-site{
            margin: auto;
            width: 1024px;
            height: 1400px;
            position: relative;
            z-index: 0;
        }
        .publisher-site > #unlockable-btn{
            position: absolute;
            opacity: 0;
            background: black;
            height: 35px;
            width: 165px;
            z-index: 1;
        }
        .publisher-site.NYT  > #unlockable-btn{
            top: 635px;
            left: 715px;
        }
        .publisher-site.Pandora > #unlockable-btn{
            top: 700px;
            left: 274px;
        }
        .publisher-site.CondeNast  > #unlockable-btn{
            top: 880px;
            left: 506px;
        }
        .publisher-site.Amazon1024  > #unlockable-btn{
            top: 323px;
            left: 816px;
        }
        .publisher-site.Moxie  > #unlockable-btn{
            top: 323px;
            left: 816px;
        }
    </style>
    <!-- URL to be appended after ? for dynamic landing page with Unlock button positioning
        Pandora: "?name=Pandora&top=691&left=526"
        NY Times: "?name=NYT&top=610&left=911"
        Conde Nast: "?name=CondeNast&top=861&left=485"
        ?name=Amazon1024&
    -->

    <div  id="unlockable-main"></div>
    <div class="publisher-site">
        <input type="button" id="unlockable-btn" value="Unlock 1 month free" tabindex="1"></input>
    </div>
    <div>
      <input id="test" type="text"></input>
    </div>
    <script type="text/javascript">
    </script>
  </body>

</html>
